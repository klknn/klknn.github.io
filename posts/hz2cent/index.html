<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>周波数Hz比から半音階への変換</title><style>@media(prefers-color-scheme:dark){body{background-color:#222;color:#ddd}a:link{color:#88c}a:visited{color:#bbc}a:hover{color:#f88}a:active{color:#f80}}h1,h2,h3,h4,h5,h6{margin:2rem auto 1rem;max-width:50rem}.single-metadata{margin:auto;padding:auto;line-height:.5rem;max-width:50rem;border:dotted}.neighbour-pages{font-style:italic;padding:1rem}p,.highlight,.gist-file,figure,hr,.twitter-tweet,.footnotes{margin:1rem auto;max-width:50rem}.footnote-body{margin:1rem}blockquote{margin:1rem auto;max-width:45rem;font-style:italic;border-left:solid 5px}ol,ul,li{margin:.75rem auto;max-width:50rem}p img{width:100%}table,th,td{border-collapse:collapse;border:1px solid;line-height:1.5;padding:10px;border-left:none;border-right:none;margin:1rem auto;max-width:50rem}figcaption{text-align:center;font-style:italic}.index-date{text-align:right;font-style:italic}pre{overflow:scroll}</style><script>MathJax={tex:{tags:"ams",inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js></script></head><body><a href=/>klknn log</a> /
<a href=/posts/>posts</a> /
<a href=/tags/>tags</a> /
<a href=/works/>works</a> /
<a href=/index.xml>feed</a> /
<a href=https://github.com/klknn/klknn.github.io>src</a><h1>周波数Hz比から半音階への変換</h1><div class=single-metadata><ul><li>date: 2024-08-12 13:25:33 +0900 <a href=https://github.com/klknn/klknn.github.io/edit/develop/content/hz2cent>edit</a></li><li>tags:
<a href=/tags/dtm/>dtm</a>,
<a href=/tags/music/>music</a></li><li>toc:<nav id=TableOfContents><ul><li><a href=#やり方>やり方</a></li><li><a href=#プラグインの設定>プラグインの設定</a></li></ul></nav></li></ul></div><p>オーケストラなどA=440Hz以外の基準周波数で録音するとき、440Hzで設定されてるプラグイン側の周波数を修正したいことはよくある。しかし大抵は半音単位やセントでチューニングを指定することになる。それを自動的に求めるJSを書いてみた。</p><h2 id=やり方>やり方</h2><p>プラグイン標準の基準周波数 x (例 440Hz) 、目的の基準周波数 y (例 443Hz) に変更するには半音階のパラメータ z との間には、1オクターブ (= 2倍の周波数間) を12等分する平均律の定義から:</p><p>\begin{align}
2 ^\frac{z}{12} &= \frac{y}{x} \newline
z &= 12 \log_2 \frac{y}{x}
\end{align}</p><p>たとえば 440Hz の音源を 443Hz にピッチシフトしたい場合は $ z = 12 \log_2 \frac{443}{440} = 0.1176381&mldr; $ 半音上げれば良い。関数電卓が手元にない人のためにJavaScriptで書いてみると、こんな感じ:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>cent</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;cent&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>target</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;target&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>source</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;source&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>hz2cent</span>(<span style=color:#a6e22e>unused</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> parseFloat(<span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>tgt</span> <span style=color:#f92672>=</span> parseFloat(<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cent</span>.<span style=color:#a6e22e>innerText</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>log2</span>(<span style=color:#a6e22e>tgt</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>src</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>hz2cent</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;keyup&#39;</span>, <span style=color:#a6e22e>hz2cent</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;keyup&#39;</span>, <span style=color:#a6e22e>hz2cent</span>);
</span></span></code></pre></div><p><ul><li>Source [Hz]: <textarea id=source rows=1>440</textarea></li><li>Target [Hz]: <textarea id=target rows=1>443</textarea></li><li>Note: <span id=cent>0</span></li></ul></p><script src=/js/hz2cent.js></script><h2 id=プラグインの設定>プラグインの設定</h2><p>シンセサイザーなどはユニゾンのためなど比較的わかりやすくfinetuneなどの項目があるが、サンプラー系はわかりにくいので注意。</p><p>East West Playの場合はここ</p><p><img src=https://github.com/user-attachments/assets/24662da4-5886-4d44-bbed-39bab4f8579c alt=image></p><p>Kontakt の場合はここ</p><p><img src=https://github.com/user-attachments/assets/0754f988-b824-41ce-a1db-bdb5a9263c18 alt=image></p><div class=neighbour-pages><hr><p><a href=#>Back to top</a></p><p><a href=https://klknn.github.io/posts/20240506/>Prev: IK ARC Studio、バイオリン購入など</a></p><p><a href=https://klknn.github.io/posts/gvb/>Next: スバル インプレッサ購入</a></p></div>Copyright © klknn All Rights Reserved.</body></html>